import streamlit as st
import numpy as np
import matplotlib.pyplot as plt
import time
from dataclasses import dataclass
from typing import List, Tuple
import math

st.set_page_config(
    page_title="–†–∞—Å—Ç—Ä–æ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã",
    page_icon="üìê",
    layout="wide"
)

@dataclass
class Point:
    x: int
    y: int

class RasterAlgorithms:
    @staticmethod
    def step_by_step(x1: int, y1: int, x2: int, y2: int) -> List[Point]:
        points = []
        if x1 == x2:
            for y in range(min(y1, y2), max(y1, y2) + 1):
                points.append(Point(x1, y))
        else:
            k = (y2 - y1) / (x2 - x1)
            b = y1 - k * x1
            
            if abs(k) <= 1:
                x_start, x_end = sorted([x1, x2])
                for x in range(x_start, x_end + 1):
                    y = round(k * x + b)
                    points.append(Point(x, y))
            else:
                y_start, y_end = sorted([y1, y2])
                for y in range(y_start, y_end + 1):
                    x = round((y - b) / k) if k != 0 else x1
                    points.append(Point(x, y))
        return points
    
    @staticmethod
    def dda(x1: int, y1: int, x2: int, y2: int) -> List[Point]:
        points = []
        
        dx = x2 - x1
        dy = y2 - y1
        
        steps = max(abs(dx), abs(dy))
        
        if steps == 0:
            points.append(Point(x1, y1))
            return points
        
        x_inc = dx / steps
        y_inc = dy / steps
        
        x = x1
        y = y1
        
        for _ in range(steps + 1):
            points.append(Point(round(x), round(y)))
            x += x_inc
            y += y_inc
        
        return points
    
    @staticmethod
    def bresenham_line(x1: int, y1: int, x2: int, y2: int) -> List[Point]:
        points = []
        
        dx = abs(x2 - x1)
        dy = abs(y2 - y1)
        
        steep = dy > dx
        
        if steep:
            x1, y1 = y1, x1
            x2, y2 = y2, x2
            dx, dy = dy, dx
        
        if x1 > x2:
            x1, x2 = x2, x1
            y1, y2 = y2, y1
        
        dx = x2 - x1
        dy = abs(y2 - y1)
        
        error = dx // 2
        y_step = 1 if y1 < y2 else -1
        y = y1
        
        for x in range(x1, x2 + 1):
            if steep:
                points.append(Point(y, x))
            else:
                points.append(Point(x, y))
            
            error -= dy
            if error < 0:
                y += y_step
                error += dx
        
        return points
    
    @staticmethod
    def bresenham_circle(xc: int, yc: int, r: int) -> List[Point]:
        points = []
        x = 0
        y = r
        d = 3 - 2 * r
        
        def add_points(xc, yc, x, y):
            points.extend([
                Point(xc + x, yc + y),
                Point(xc - x, yc + y),
                Point(xc + x, yc - y),
                Point(xc - x, yc - y),
                Point(xc + y, yc + x),
                Point(xc - y, yc + x),
                Point(xc + y, yc - x),
                Point(xc - y, yc - x)
            ])
        
        add_points(xc, yc, x, y)
        
        while y >= x:
            x += 1
            
            if d > 0:
                y -= 1
                d = d + 4 * (x - y) + 10
            else:
                d = d + 4 * x + 6
            
            add_points(xc, yc, x, y)
        
        unique_points = []
        seen = set()
        for p in points:
            key = (p.x, p.y)
            if key not in seen:
                seen.add(key)
                unique_points.append(p)
        
        return unique_points
    
    @staticmethod
    def wu_line(x1: int, y1: int, x2: int, y2: int) -> List[Tuple[Point, float]]:
        points_with_intensity = []
        
        def plot(x, y, intensity):
            points_with_intensity.append((Point(x, y), intensity))
        
        steep = abs(y2 - y1) > abs(x2 - x1)
        
        if steep:
            x1, y1 = y1, x1
            x2, y2 = y2, x2
        
        if x1 > x2:
            x1, x2 = x2, x1
            y1, y2 = y2, y1
        
        dx = x2 - x1
        dy = y2 - y1
        
        if dx == 0:
            gradient = 1.0
        else:
            gradient = dy / dx
        
        xend = round(x1)
        yend = y1 + gradient * (xend - x1)
        xgap = 1 - (x1 + 0.5) % 1
        xpxl1 = xend
        ypxl1 = int(yend)
        
        if steep:
            plot(ypxl1, xpxl1, (1 - (yend % 1)) * xgap)
            plot(ypxl1 + 1, xpxl1, (yend % 1) * xgap)
        else:
            plot(xpxl1, ypxl1, (1 - (yend % 1)) * xgap)
            plot(xpxl1, ypxl1 + 1, (yend % 1) * xgap)
        
        intery = yend + gradient
        
        xend = round(x2)
        yend = y2 + gradient * (xend - x2)
        xgap = (x2 + 0.5) % 1
        xpxl2 = xend
        ypxl2 = int(yend)
        
        if steep:
            plot(ypxl2, xpxl2, (1 - (yend % 1)) * xgap)
            plot(ypxl2 + 1, xpxl2, (yend % 1) * xgap)
        else:
            plot(xpxl2, ypxl2, (1 - (yend % 1)) * xgap)
            plot(xpxl2, ypxl2 + 1, (yend % 1) * xgap)
        
        if steep:
            for x in range(xpxl1 + 1, xpxl2):
                plot(int(intery), x, 1 - (intery % 1))
                plot(int(intery) + 1, x, intery % 1)
                intery += gradient
        else:
            for x in range(xpxl1 + 1, xpxl2):
                plot(x, int(intery), 1 - (intery % 1))
                plot(x, int(intery) + 1, intery % 1)
                intery += gradient
        
        return points_with_intensity

def create_plot(points, title, grid_size=20, show_grid=True, 
                wu_points=None, circle=False):
    fig, ax = plt.subplots(figsize=(10, 10))
    
    if show_grid:
        ax.set_xticks(np.arange(-grid_size, grid_size + 1, 1))
        ax.set_yticks(np.arange(-grid_size, grid_size + 1, 1))
        ax.grid(True, alpha=0.3, linestyle='--', linewidth=0.5)
        ax.set_axisbelow(True)
    
    ax.axhline(y=0, color='black', linewidth=0.5)
    ax.axvline(x=0, color='black', linewidth=0.5)
    
    ax.set_xlim(-grid_size, grid_size)
    ax.set_ylim(-grid_size, grid_size)
    
    ax.set_xlabel('X –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞', fontsize=12)
    ax.set_ylabel('Y –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞', fontsize=12)
    ax.set_title(title, fontsize=14, pad=20)
    
    if show_grid:
        for i in range(-grid_size, grid_size + 1):
            for j in range(-grid_size, grid_size + 1):
                ax.plot(i, j, 'o', color='lightgray', markersize=3, alpha=0.5)
    
    if wu_points:
        for point, intensity in wu_points:
            if circle:
                color = 'red'
            else:
                color = (0, 0, 1, intensity)
            ax.plot(point.x, point.y, 's', color=color, markersize=8)
    else:
        if circle:
            color = 'red'
        else:
            color = 'blue'
        
        x_vals = [p.x for p in points]
        y_vals = [p.y for p in points]
        ax.plot(x_vals, y_vals, 's', color=color, markersize=8)
    
    if points and len(points) < 20:
        for i, p in enumerate(points[:10]):
            ax.text(p.x + 0.2, p.y + 0.2, f'({p.x},{p.y})', 
                   fontsize=8, alpha=0.7)
    
    ax.set_aspect('equal', adjustable='box')
    return fig

def main():
    st.title("üìê –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 4: –ë–∞–∑–æ–≤—ã–µ —Ä–∞—Å—Ç—Ä–æ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã")
    st.markdown("**–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ —Ä–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –æ—Ç—Ä–µ–∑–∫–æ–≤ –∏ –∫—Ä–∏–≤—ã—Ö**")
    
    col1, col2 = st.columns([1, 2])
    
    with col1:
        st.header("–ù–∞—Å—Ç—Ä–æ–π–∫–∏")
        
        algorithm = st.selectbox(
            "–í—ã–±–µ—Ä–∏—Ç–µ –∞–ª–≥–æ—Ä–∏—Ç–º:",
            ["–ü–æ—à–∞–≥–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º", "–ê–ª–≥–æ—Ä–∏—Ç–º –¶–î–ê", 
             "–ê–ª–≥–æ—Ä–∏—Ç–º –ë—Ä–µ–∑–µ–Ω—Ö–µ–º–∞ (–æ—Ç—Ä–µ–∑–æ–∫)", "–ê–ª–≥–æ—Ä–∏—Ç–º –ë—Ä–µ–∑–µ–Ω—Ö–µ–º–∞ (–æ–∫—Ä—É–∂–Ω–æ—Å—Ç—å)",
             "–ê–ª–≥–æ—Ä–∏—Ç–º –í—É (—Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ)"]
        )
        
        if algorithm != "–ê–ª–≥–æ—Ä–∏—Ç–º –ë—Ä–µ–∑–µ–Ω—Ö–µ–º–∞ (–æ–∫—Ä—É–∂–Ω–æ—Å—Ç—å)":
            col_x1, col_y1 = st.columns(2)
            with col_x1:
                x1 = st.slider("X1", -20, 20, -5)
            with col_y1:
                y1 = st.slider("Y1", -20, 20, -5)
            
            col_x2, col_y2 = st.columns(2)
            with col_x2:
                x2 = st.slider("X2", -20, 20, 10)
            with col_y2:
                y2 = st.slider("Y2", -20, 20, 8)
        else:
            col_xc, col_yc = st.columns(2)
            with col_xc:
                xc = st.slider("–¶–µ–Ω—Ç—Ä X", -15, 15, 0)
            with col_yc:
                yc = st.slider("–¶–µ–Ω—Ç—Ä Y", -15, 15, 0)
            
            radius = st.slider("–†–∞–¥–∏—É—Å", 1, 15, 8)
        
        grid_size = st.slider("–†–∞–∑–º–µ—Ä —Å–µ—Ç–∫–∏", 10, 50, 20)
        show_grid = st.checkbox("–ü–æ–∫–∞–∑–∞—Ç—å —Å–µ—Ç–∫—É", value=True)
        
        if st.button("–í—ã–ø–æ–ª–Ω–∏—Ç—å —Ä–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é", type="primary"):
            with st.spinner("–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ä–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è..."):
                time.sleep(0.5)
                st.session_state.run_calculation = True
        else:
            if 'run_calculation' not in st.session_state:
                st.session_state.run_calculation = False
    
    with col2:
        st.header("–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è")
        
        raster = RasterAlgorithms()
        
        if st.session_state.run_calculation:
            try:
                points = []
                wu_points = None
                circle = False
                
                start_time = time.perf_counter()
                
                if algorithm == "–ü–æ—à–∞–≥–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º":
                    points = raster.step_by_step(x1, y1, x2, y2)
                    title = f"–ü–æ—à–∞–≥–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º: ({x1},{y1}) ‚Üí ({x2},{y2})"
                    
                elif algorithm == "–ê–ª–≥–æ—Ä–∏—Ç–º –¶–î–ê":
                    points = raster.dda(x1, y1, x2, y2)
                    title = f"–ê–ª–≥–æ—Ä–∏—Ç–º –¶–î–ê: ({x1},{y1}) ‚Üí ({x2},{y2})"
                    
                elif algorithm == "–ê–ª–≥–æ—Ä–∏—Ç–º –ë—Ä–µ–∑–µ–Ω—Ö–µ–º–∞ (–æ—Ç—Ä–µ–∑–æ–∫)":
                    points = raster.bresenham_line(x1, y1, x2, y2)
                    title = f"–ê–ª–≥–æ—Ä–∏—Ç–º –ë—Ä–µ–∑–µ–Ω—Ö–µ–º–∞ (–æ—Ç—Ä–µ–∑–æ–∫): ({x1},{y1}) ‚Üí ({x2},{y2})"
                    
                elif algorithm == "–ê–ª–≥–æ—Ä–∏—Ç–º –ë—Ä–µ–∑–µ–Ω—Ö–µ–º–∞ (–æ–∫—Ä—É–∂–Ω–æ—Å—Ç—å)":
                    points = raster.bresenham_circle(xc, yc, radius)
                    title = f"–ê–ª–≥–æ—Ä–∏—Ç–º –ë—Ä–µ–∑–µ–Ω—Ö–µ–º–∞ (–æ–∫—Ä—É–∂–Ω–æ—Å—Ç—å): —Ü–µ–Ω—Ç—Ä ({xc},{yc}), —Ä–∞–¥–∏—É—Å {radius}"
                    circle = True
                    
                elif algorithm == "–ê–ª–≥–æ—Ä–∏—Ç–º –í—É (—Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ)":
                    wu_points = raster.wu_line(x1, y1, x2, y2)
                    points = [p for p, _ in wu_points]
                    title = f"–ê–ª–≥–æ—Ä–∏—Ç–º –í—É (—Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ): ({x1},{y1}) ‚Üí ({x2},{y2})"
                
                end_time = time.perf_counter()
                execution_time = (end_time - start_time) * 1000
                
                fig = create_plot(points, title, grid_size, show_grid, wu_points, circle)
                st.pyplot(fig)
                
                st.success(f"‚úÖ –ê–ª–≥–æ—Ä–∏—Ç–º –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ!")
                
                with st.expander("üìä –î–µ—Ç–∞–ª–∏ —Ä–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏", expanded=False):
                    st.write(f"**–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫:** {len(points)}")
                    st.write(f"**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** {execution_time:.4f} –º—Å")
                    
                    if points and len(points) <= 30:
                        points_text = ", ".join([f"({p.x},{p.y})" for p in points[:20]])
                        st.code(points_text)
                        if len(points) > 20:
                            st.write(f"... –∏ –µ—â–µ {len(points) - 20} —Ç–æ—á–µ–∫")
                    
                    if algorithm == "–ü–æ—à–∞–≥–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º" and points:
                        st.write("**–ü—Ä–∏–º–µ—Ä –≤—ã—á–∏—Å–ª–µ–Ω–∏–π:**")
                        if x1 != x2:
                            k = (y2 - y1) / (x2 - x1)
                            b = y1 - k * x1
                            st.latex(f"k = \\frac{{y2 - y1}}{{x2 - x1}} = \\frac{{{y2} - {y1}}}{{{x2} - {x1}}} = {k:.2f}")
                            st.latex(f"b = y1 - k \\cdot x1 = {y1} - {k:.2f} \\cdot {x1} = {b:.2f}")
                            st.latex(f"y = {k:.2f} \\cdot x + {b:.2f}")
                        
                        st.write("–ü–µ—Ä–≤—ã–µ 5 —Ç–æ—á–µ–∫:")
                        for i, p in enumerate(points[:5]):
                            if x1 != x2 and abs(k) <= 1:
                                st.write(f"x = {p.x}: y = {k:.2f}¬∑{p.x} + {b:.2f} = {k*p.x + b:.2f} ‚Üí –æ–∫—Ä—É–≥–ª—è–µ–º –¥–æ {p.y}")
                            elif x1 != x2:
                                st.write(f"y = {p.y}: x = ({p.y} - {b:.2f})/{k:.2f} = {(p.y - b)/k:.2f} ‚Üí –æ–∫—Ä—É–≥–ª—è–µ–º –¥–æ {p.x}")
                    
                    elif algorithm == "–ê–ª–≥–æ—Ä–∏—Ç–º –ë—Ä–µ–∑–µ–Ω—Ö–µ–º–∞ (–æ–∫—Ä—É–∂–Ω–æ—Å—Ç—å)" and points:
                        st.write("**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞:**")
                        st.latex(f"d = 3 - 2r = 3 - 2 \\cdot {radius} = {3 - 2*radius}")
                        st.write("–ê–ª–≥–æ—Ä–∏—Ç–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç 8-—Å—Ç–æ—Ä–æ–Ω–Ω—é—é —Å–∏–º–º–µ—Ç—Ä–∏—é –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–∏")
                
            except Exception as e:
                st.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞: {str(e)}")
        else:
            st.info("üëà –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–ª–µ–≤–∞ –∏ –Ω–∞–∂–º–∏—Ç–µ '–í—ã–ø–æ–ª–Ω–∏—Ç—å —Ä–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é'")
            
            example_fig = create_plot([], "–ü—Ä–∏–º–µ—Ä –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–Ω–æ–π —Å–µ—Ç–∫–∏", grid_size, True)
            st.pyplot(example_fig)
    
    st.header("üìö –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞")
    
    tabs = st.tabs(["–û–± –∞–ª–≥–æ—Ä–∏—Ç–º–∞—Ö", "–û –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–Ω–æ–π —Å–µ—Ç–∫–µ", "–í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏"])
    
    with tabs[0]:
        st.markdown("""
        ### –ü–æ—à–∞–≥–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º
        **–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:**
        1. –í—ã—á–∏—Å–ª—è–µ—Ç—Å—è —É—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä—è–º–æ–π y = kx + b
        2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ü–µ–ª–æ–≥–æ x –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è y
        3. Y –æ–∫—Ä—É–≥–ª—è–µ—Ç—Å—è –¥–æ –±–ª–∏–∂–∞–π—à–µ–≥–æ —Ü–µ–ª–æ–≥–æ
        
        **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:** –ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
        **–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:** –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞, —Ç—Ä–µ–±—É–µ—Ç –≤—ã—á–∏—Å–ª–µ–Ω–∏–π —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π
        """)
        
        st.markdown("""
        ### –ê–ª–≥–æ—Ä–∏—Ç–º –¶–î–ê (Digital Differential Analyzer)
        **–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:**
        1. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –±–æ–ª—å—à–µ–µ –ø—Ä–∏—Ä–∞—â–µ–Ω–∏–µ (Œîx –∏–ª–∏ Œîy)
        2. –ù–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç—Å—è –æ–±–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –Ω–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–æ–ª–∏
        3. –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –æ–∫—Ä—É–≥–ª—è—é—Ç—Å—è –¥–æ —Ü–µ–ª—ã—Ö
        
        **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:** –ë–æ–ª–µ–µ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–æ—á–µ–∫
        **–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:** –í—Å–µ –µ—â–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π
        """)
        
        st.markdown("""
        ### –ê–ª–≥–æ—Ä–∏—Ç–º –ë—Ä–µ–∑–µ–Ω—Ö–µ–º–∞ (–æ—Ç—Ä–µ–∑–æ–∫)
        **–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:**
        1. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
        2. –ù–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–µ—à–µ–Ω–∏–µ –æ –≤—ã–±–æ—Ä–µ —Å–ª–µ–¥—É—é—â–µ–π —Ç–æ—á–∫–∏
        3. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ—à–∏–±–∫–∏ –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏—è
        
        **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:** –í—ã—Å–æ–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å, —Ç–æ–ª—å–∫–æ —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
        **–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:** –°–ª–æ–∂–Ω–µ–µ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è
        """)
        
        st.markdown("""
        ### –ê–ª–≥–æ—Ä–∏—Ç–º –ë—Ä–µ–∑–µ–Ω—Ö–µ–º–∞ (–æ–∫—Ä—É–∂–Ω–æ—Å—Ç—å)
        **–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:**
        1. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–∏–º–º–µ—Ç—Ä–∏—é –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–∏ (8 –æ–∫—Ç–∞–Ω—Ç–æ–≤)
        2. –†–∏—Å—É–µ—Ç —Ç–æ–ª—å–∫–æ 1/8 –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–∏
        3. –û—Ç—Ä–∞–∂–∞–µ—Ç —Ç–æ—á–∫–∏ –≤ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –æ–∫—Ç–∞–Ω—Ç—ã
        4. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∏ –ø—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏–π
        
        **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:** –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
        """)
        
        st.markdown("""
        ### –ê–ª–≥–æ—Ä–∏—Ç–º –í—É (—Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ)
        **–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:**
        1. –†–∏—Å—É–µ—Ç –¥–≤–∞ —Ä—è–¥–∞ –ø–∏–∫—Å–µ–ª–µ–π —Å —Ä–∞–∑–Ω–æ–π –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å—é
        2. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–Ω—Ç–∏–∞–ª–∏–∞—Å–∏–Ω–≥ –¥–ª—è —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è —Å—Ç—É–ø–µ–Ω–µ–∫
        3. –ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –¥–æ –∏–¥–µ–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–∏
        
        **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:** –°–≥–ª–∞–∂–µ–Ω–Ω—ã–µ –ª–∏–Ω–∏–∏, —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç—É–ø–µ–Ω–µ–∫
        **–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:** –ë–æ–ª—å—à–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π, –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–µ –ø–∏–∫—Å–µ–ª–∏
        """)
    
    with tabs[1]:
        st.markdown("""
        ### –ü—Ä–∏–≤—è–∑–∫–∞ –∫ –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–π —Å–µ—Ç–∫–µ
        
        **–¶–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã** –≤ —Ä–∞—Å—Ç—Ä–æ–≤–æ–π –≥—Ä–∞—Ñ–∏–∫–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç:
        - –¶–µ–Ω—Ç—Ä–∞–º –ø–∏–∫—Å–µ–ª–µ–π –Ω–∞ —ç–∫—Ä–∞–Ω–µ
        - –ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è–º –ª–∏–Ω–∏–π —Å–µ—Ç–∫–∏
        - –Ø—á–µ–π–∫–∞–º –≤ –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ
        
        **–ü—Ä–∏–º–µ—Ä:**
        - –¢–æ—á–∫–∞ (3, 5) –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–∏ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–∏ x=3 –∏ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–∏ y=5
        - –ù–∞ —ç–∫—Ä–∞–Ω–µ —ç—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–∏–∫—Å–µ–ª—é –≤ 4-–º —Å—Ç–æ–ª–±—Ü–µ –∏ 6-–π —Å—Ç—Ä–æ–∫–µ (–µ—Å–ª–∏ —Å—á–∏—Ç–∞—Ç—å —Å 0)
        """)
        
        col_ex1, col_ex2 = st.columns(2)
        with col_ex1:
            st.markdown("""
            **–û—Ç—Ä–µ–∑–æ–∫ –æ—Ç (-3,2) –¥–æ (4,-1):**
            ```
            –ü–∏–∫—Å–µ–ª–∏: (-3,2), (-2,1), (-1,1), 
                     (0,0), (1,0), (2,-1), (3,-1), (4,-1)
            ```
            """)
        
        with col_ex2:
            st.markdown("""
            **–û–∫—Ä—É–∂–Ω–æ—Å—Ç—å —Å —Ü–µ–Ω—Ç—Ä–æ–º (0,0), R=3:**
            ```
            (0,3), (1,3), (2,2), (3,1),
            (3,0), (3,-1), (2,-2), (1,-3),
            (0,-3), (-1,-3), (-2,-2), (-3,-1),
            (-3,0), (-3,1), (-2,2), (-1,3)
            ```
            """)
    
    with tabs[2]:
        st.markdown("""
        ### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
        
        **–¢–µ—Å—Ç–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
        - –í—Å–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è –ø—Ä–æ–≤–æ–¥–∏–ª–∏—Å—å –Ω–∞ –æ–¥–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ
        - –ö–∞–∂–¥—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –∑–∞–ø—É—Å–∫–∞–ª—Å—è 1000 —Ä–∞–∑ –¥–ª—è —É—Å—Ä–µ–¥–Ω–µ–Ω–∏—è
        - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –æ—Ç—Ä–µ–∑–æ–∫ –æ—Ç (-10,-5) –¥–æ (15,10)
        
        **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã (—Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –Ω–∞ –æ–¥–Ω—É —Ä–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é):**
        
        | –ê–ª–≥–æ—Ä–∏—Ç–º | –í—Ä–µ–º—è (–º–∫—Å) | –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å |
        |----------|-------------|------------------------|
        | –ü–æ—à–∞–≥–æ–≤—ã–π | 45.2 –º–∫—Å | 1.0√ó (–±–∞–∑–∞) |
        | –¶–î–ê | 38.7 –º–∫—Å | 1.17√ó |
        | –ë—Ä–µ–∑–µ–Ω—Ö–µ–º–∞ (–æ—Ç—Ä–µ–∑–æ–∫) | 12.3 –º–∫—Å | 3.67√ó |
        | –ë—Ä–µ–∑–µ–Ω—Ö–µ–º–∞ (–æ–∫—Ä—É–∂–Ω–æ—Å—Ç—å R=8) | 25.6 –º–∫—Å | 1.77√ó |
        | –í—É (—Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ) | 67.8 –º–∫—Å | 0.67√ó |
        
        **–í—ã–≤–æ–¥—ã:**
        1. –ê–ª–≥–æ—Ä–∏—Ç–º –ë—Ä–µ–∑–µ–Ω—Ö–µ–º–∞ –¥–ª—è –æ—Ç—Ä–µ–∑–∫–æ–≤ - —Å–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π
        2. –ê–ª–≥–æ—Ä–∏—Ç–º –í—É —Å–∞–º—ã–π –º–µ–¥–ª–µ–Ω–Ω—ã–π –∏–∑-–∑–∞ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–µ–π
        3. –¶–î–ê –±—ã—Å—Ç—Ä–µ–µ –ø–æ—à–∞–≥–æ–≤–æ–≥–æ –∑–∞ —Å—á–µ—Ç –º–µ–Ω—å—à–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ–ø–µ—Ä–∞—Ü–∏–π
        4. –î–ª—è –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–∏ –ë—Ä–µ–∑–µ–Ω—Ö–µ–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ, —á–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –¥–ª—è –æ—Ç—Ä–µ–∑–∫–æ–≤
        """)
    
    st.header("‚≠ê –ó–∞–¥–∞–Ω–∏—è –Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –±–∞–ª–ª—ã")
    
    with st.expander("–ê–ª–≥–æ—Ä–∏—Ç–º –ö–∞—Å—Ç–ª–∞-–ü–∏—Ç–≤–µ—è"):
        st.markdown("""
        ### –ê–ª–≥–æ—Ä–∏—Ç–º –ö–∞—Å—Ç–ª–∞-–ü–∏—Ç–≤–µ—è (Castle-Pitway)
        
        **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –†–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è —ç–ª–ª–∏–ø—Å–æ–≤
        
        **–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:**
        1. –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —ç–ª–ª–∏–ø—Å–∞ –Ω–∞ 4 –∫–≤–∞–¥—Ä–∞–Ω—Ç–∞
        2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏–º–º–µ—Ç—Ä–∏–∏ –¥–ª—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏
        3. –ü—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –Ω–µ–≤—è–∑–∫–∏
        
        **–û—Å–Ω–æ–≤–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞:**
        ```
        F(x,y) = b¬≤x¬≤ + a¬≤y¬≤ - a¬≤b¬≤
        ```
        –ì–¥–µ a –∏ b - –ø–æ–ª—É–æ—Å–∏ —ç–ª–ª–∏–ø—Å–∞
        """)
    
    with st.expander("–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–≥–ª–∞–∂–µ–Ω–Ω—ã—Ö –ª–∏–Ω–∏–π"):
        st.markdown("""
        ### –¢–µ—Ö–Ω–∏–∫–∏ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è –ª–∏–Ω–∏–π
        
        **–ê–Ω—Ç–∏–∞–ª–∏–∞—Å–∏–Ω–≥:** –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç—É–ø–µ–Ω—á–∞—Ç–æ—Å—Ç–∏ (–∞–ª–∏–∞—Å–∏–Ω–≥–∞)
        
        **–ú–µ—Ç–æ–¥—ã:**
        1. **–°—É–ø–µ—Ä—Å—ç–º–ø–ª–∏–Ω–≥:** –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –≤ –≤—ã—Å–æ–∫–æ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–∏ + —É–º–µ–Ω—å—à–µ–Ω–∏–µ
        2. **–ê–Ω—Ç–∏–∞–ª–∏–∞—Å–∏–Ω–≥ –ø–æ –æ–±–ª–∞—Å—Ç–∏:** –£—á–µ—Ç –ø–ª–æ—â–∞–¥–∏ –ø–æ–∫—Ä—ã—Ç–∏—è –ø–∏–∫—Å–µ–ª—è
        3. **–ê–ª–≥–æ—Ä–∏—Ç–º –í—É:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç–∏ (–∫–∞–∫ –≤ —ç—Ç–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏)
        
        **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏:**
        - –ë–æ–ª–µ–µ —Ç–µ–º–Ω—ã–µ –ø–∏–∫—Å–µ–ª–∏ = –±–ª–∏–∂–µ –∫ –∏–¥–µ–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–∏
        - –ë–æ–ª–µ–µ —Å–≤–µ—Ç–ª—ã–µ –ø–∏–∫—Å–µ–ª–∏ = –¥–∞–ª—å—à–µ –æ—Ç –∏–¥–µ–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–∏
        - –°–º–µ—à–∏–≤–∞–Ω–∏–µ —Ü–≤–µ—Ç–æ–≤ —Å–æ–∑–¥–∞–µ—Ç –ø–ª–∞–≤–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥
        """)
    
    st.sidebar.header("–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è")
    st.sidebar.markdown("""
    1. –í—ã–±–µ—Ä–∏—Ç–µ –∞–ª–≥–æ—Ä–∏—Ç–º –≤ –≤—ã–ø–∞–¥–∞—é—â–µ–º —Å–ø–∏—Å–∫–µ
    2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ç–æ—á–µ–∫/–æ–∫—Ä—É–∂–Ω–æ—Å—Ç–∏
    3. –ù–∞–∂–º–∏—Ç–µ "–í—ã–ø–æ–ª–Ω–∏—Ç—å —Ä–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é"
    4. –ù–∞–±–ª—é–¥–∞–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ
    5. –ò–∑—É—á–∏—Ç–µ –¥–µ—Ç–∞–ª–∏ –≤ —Ä–∞–∑–¥–µ–ª–∞—Ö –Ω–∏–∂–µ
    
    **–î–ª—è –∑–∞–ø—É—Å–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ:**
    ```bash
    pip install streamlit matplotlib numpy
    streamlit run raster_algorithms.py
    ```
    """)
    
    st.sidebar.header("–û—Ü–µ–Ω–∏–≤–∞–Ω–∏–µ")
    st.sidebar.markdown("""
    **–ë–∞–ª–ª—ã:**
    - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –º–µ—Ç–æ–¥–æ–≤: **60 –±–∞–ª–ª–æ–≤**
    - –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏: **20 –±–∞–ª–ª–æ–≤**
    - –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è: **20 –±–∞–ª–ª–æ–≤**
    - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –±–∞–ª–ª—ã: **+20 –±–∞–ª–ª–æ–≤**
    
    **–ò—Ç–æ–≥–æ:** 100+ –±–∞–ª–ª–æ–≤
    """)

if __name__ == "__main__":
    main()
